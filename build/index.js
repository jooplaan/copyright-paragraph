(()=>{"use strict";const t=window.wp.blocks,e=window.wp.i18n;(0,t.registerBlockVariation)("core/paragraph",{name:"copyright-paragraph",title:(0,e.__)("Copyright Text","copyright-paragraph"),description:(0,e.__)("Add Â© + current year + site title","copyright-paragraph"),attributes:{content:"",metadata:{bindings:{content:{source:"copyright-paragraph/copyright",args:{startYear:(new Date).getFullYear().toString(),customName:""}}}}},scope:["inserter"],icon:"admin-site-alt3"});const r=window.wp.hooks,a=window.wp.element,o=window.wp.data,n=window.wp.compose,i=window.wp.blockEditor,c=window.wp.components;console.log("ðŸ§  edit.js is geladen");const p=(0,n.createHigherOrderComponent)((t=>r=>{const{name:n,attributes:c}=r;if("core/paragraph"!==n)return(0,a.createElement)(t,{...r});const p=c?.metadata?.bindings?.content;if(!p||"copyright-paragraph/copyright"!==p.source)return(0,a.createElement)(t,{...r});const s=p.args||{},g=parseInt(s.startYear,10),l=s.customName?.trim(),d=(new Date).getFullYear(),h=g&&g<d?`${g} â€“ ${d}`:d,m=(0,o.useSelect)((t=>{const r=t("core").getEntityRecord("root","site");return r?.title||(0,e.__)("Site Title","copyright-paragraph")}),[]),u=`Â© ${h} ${l||m}`;return(0,a.createElement)("div",{...r},(0,a.createElement)(i.RichText,{tagName:"p",value:u,readOnly:!0}))}),"withCopyrightEditPreview");(0,r.addFilter)("editor.BlockEdit","copyright-paragraph/edit-preview",p);const s=(0,n.createHigherOrderComponent)((t=>r=>{const{name:n,attributes:p,clientId:s}=r;if("core/paragraph"!==n)return(0,a.createElement)(t,{...r});const g=p?.metadata?.bindings?.content;if(!g||"copyright-paragraph/copyright"!==g.source)return(0,a.createElement)(t,{...r});const l=g.args||{},d=l.startYear||"",h=l.customName||"",{updateBlockAttributes:m}=(0,o.useDispatch)("core/block-editor"),u=(t,e)=>{m(s,{metadata:{...p.metadata,bindings:{...p.metadata.bindings,content:{...p.metadata.bindings.content,args:{...l,[t]:e}}}}})};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(t,{...r}),(0,a.createElement)(i.InspectorControls,null,(0,a.createElement)(c.PanelBody,{title:(0,e.__)("Copyright Settings","copyright-paragraph"),initialOpen:!0},(0,a.createElement)(c.TextControl,{label:(0,e.__)("Custom Name","copyright-paragraph"),value:h,onChange:t=>u("customName",t),placeholder:(0,e.__)("Leave empty to use site title","copyright-paragraph")}),(0,a.createElement)(c.TextControl,{label:(0,e.__)("Start Year","copyright-paragraph"),type:"number",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:t=>{const e=t.replace(/\D/g,"");u("startYear",e)},placeholder:(new Date).getFullYear(),min:"1900",max:(new Date).getFullYear()}))))}),"withCopyrightInspectorControls");(0,r.addFilter)("editor.BlockEdit","copyright-paragraph/inspector-controls",s);const g=window.wp.coreData;(0,t.registerBlockBindingsSource)({name:"copyright-paragraph/copyright",label:(0,e.__)("Copyright Info","copyright-paragraph"),usesContext:["postType","postId","post"],getValues({select:t,context:r,sourceArgs:a}){if(!a||void 0===a.startYear||void 0===a.customName)try{const t=r?.block,e=t?.attributes?.metadata?.bindings?.content?.args;e&&(a={...a,...e})}catch(t){console.warn("â›” Can't deduct sourceArgs from block context:",t)}const{getEntityRecord:o,getIsResolving:n}=t(g.store);if(n("root","site"))return{};const i=o("root","site"),c=i?.title||(0,e.__)("Site title","copyright-paragraph"),p=(new Date).getFullYear(),s=parseInt(a?.startYear,10),l=a?.customName?.trim();return{content:`Â© ${s&&s<p?`${s} â€“ ${p}`:p} ${l||c}`}}})})();