(()=>{"use strict";const t=window.wp.blocks,e=window.wp.i18n;(0,t.registerBlockVariation)("core/paragraph",{name:"copyright-paragraph",title:(0,e.__)("Copyright Text","copyright-paragraph"),description:(0,e.__)("Add © + current year + site title","copyright-paragraph"),attributes:{content:"",metadata:{bindings:{content:{source:"copyright-paragraph/copyright",args:{customSymbol:"",startYear:(new Date).getFullYear().toString(),customName:""}}}}},scope:["inserter"],icon:"admin-site-alt3"});const a=window.wp.hooks,r=window.wp.element,o=window.wp.data,n=window.wp.compose,i=window.wp.blockEditor,s=window.wp.components,c=window.ReactJSXRuntime,p=(0,n.createHigherOrderComponent)((t=>a=>{const{name:n,attributes:p,clientId:g}=a;if("core/paragraph"!==n)return(0,c.jsx)(t,{...a});const l=p?.metadata?.bindings?.content;if(!l||"copyright-paragraph/copyright"!==l.source)return(0,c.jsx)(t,{...a});const m=l.args||{},[h,u]=(0,r.useState)(m.customSymbol||"©"),[d,y]=(0,r.useState)(m.customName||""),[w,b]=(0,r.useState)(m.startYear||""),_=(new Date).getFullYear(),S=parseInt(w,10),x=S&&S<_?`${S} – ${_}`:_,C=(0,o.useSelect)((t=>{const a=t("core").getEntityRecord("root","site");return a?.title||(0,e.__)("Site Title","copyright-paragraph")}),[]),Y=`${h} ${x} ${d||C}`,{updateBlockAttributes:k}=(0,o.useDispatch)("core/block-editor"),$=(t,e)=>{const a={customSymbol:h,customName:d,startYear:w,[t]:e};"customSymbol"===t&&u(e),"customName"===t&&y(e),"startYear"===t&&b(e),k(g,{metadata:{...p.metadata,bindings:{...p.metadata.bindings,content:{...p.metadata.bindings.content,args:a}}}})},j={...p,content:Y};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t,{...a,attributes:j}),(0,c.jsx)(i.InspectorControls,{children:(0,c.jsxs)(s.PanelBody,{title:(0,e.__)("Copyright Settings","copyright-paragraph"),initialOpen:!0,children:[(0,c.jsx)(s.TextControl,{label:(0,e.__)("Custom Symbol","copyright-paragraph"),value:h,onChange:t=>$("customSymbol",t),placeholder:(0,e.__)("Leave empty to use ©","copyright-paragraph")}),(0,c.jsx)(s.TextControl,{label:(0,e.__)("Custom Name","copyright-paragraph"),value:d,onChange:t=>$("customName",t),placeholder:(0,e.__)("Leave empty to use site title","copyright-paragraph")}),(0,c.jsx)(s.TextControl,{label:(0,e.__)("Start Year","copyright-paragraph"),type:"number",inputMode:"numeric",pattern:"[0-9]*",value:w,onChange:t=>$("startYear",t.replace(/\D/g,"")),placeholder:(new Date).getFullYear(),min:"1900",max:(new Date).getFullYear()})]})})]})}),"withCopyrightEnhancement");(0,a.addFilter)("editor.BlockEdit","copyright-paragraph/enhancement",p);const g=window.wp.coreData;(0,t.registerBlockBindingsSource)({name:"copyright-paragraph/copyright",label:(0,e.__)("Copyright Info","copyright-paragraph"),usesContext:["postType","postId","post"],getValues({select:t,context:a,sourceArgs:r}){if(!r||void 0===r.startYear||void 0===r.customName)try{const t=a?.block,e=t?.attributes?.metadata?.bindings?.content?.args;e&&(r={...r,...e})}catch(t){console.warn("⛔ Can't deduct sourceArgs from block context:",t)}const{getEntityRecord:o,getIsResolving:n}=t(g.store);if(n("root","site"))return{};const i=o("root","site"),s=i?.title||(0,e.__)("Site title","copyright-paragraph"),c=r?.customSymbol?.trim();console.log(r);const p=(new Date).getFullYear(),l=parseInt(r?.startYear,10),m=r?.customName?.trim();return{content:`${c||"©"} ${l&&l<p?`${l} – ${p}`:p} ${m||s}`}}})})();